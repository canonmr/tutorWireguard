<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutorial Wireguard Site-to-Site Lengkap</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Source+Code+Pro:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-light: #f8fafc;
            --bg-card: #ffffff;
            --primary: #2563eb;
            --primary-soft: #93c5fd;
            --text-main: #1f2937;
            --text-muted: #6b7280;
            --border-soft: rgba(148, 163, 184, 0.25);
        }
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(180deg, #f8fafc 0%, #eef2ff 40%, #f8fafc 100%);
            color: var(--text-main);
        }
        .container {
            max-width: 1240px;
            margin: 0 auto;
            padding: 1.5rem;
        }
        .section-title {
            font-size: 2.25rem;
            font-weight: 700;
            color: #111827;
            margin-bottom: 1.5rem;
            border-left: 4px solid var(--primary);
            padding-left: 1rem;
        }
        .hero {
            position: relative;
            overflow: hidden;
            background: radial-gradient(circle at top left, rgba(59, 130, 246, 0.18), transparent 55%),
                        radial-gradient(circle at top right, rgba(14, 165, 233, 0.12), transparent 50%),
                        linear-gradient(135deg, #1d4ed8, #2563eb, #1e40af);
            color: #fff;
        }
        .hero::before {
            content: "";
            position: absolute;
            inset: -10% 20% auto -15%;
            height: 320px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.18) 0%, rgba(255, 255, 255, 0) 70%);
            filter: blur(0px);
        }
        .hero::after {
            content: "";
            position: absolute;
            top: 45%;
            right: -10%;
            width: 360px;
            height: 360px;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.25) 0%, rgba(59, 130, 246, 0) 70%);
            transform: translateY(-50%);
        }
        .hero-inner {
            position: relative;
            z-index: 1;
            display: grid;
            gap: 2.5rem;
            padding: 6rem 0 5rem;
        }
        .hero-inner > div {
            max-width: 980px;
            margin: 0 auto;
        }
        @media (min-width: 1024px) {
            .hero-inner > div {
                max-width: 1080px;
            }
        }
        .hero-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.4rem 0.9rem;
            border-radius: 9999px;
            background: rgba(255, 255, 255, 0.18);
            color: rgba(255, 255, 255, 0.92);
            font-size: 0.875rem;
            font-weight: 500;
            letter-spacing: 0.02em;
            backdrop-filter: blur(8px);
        }
        .hero-title {
            font-size: clamp(2.5rem, 5vw, 3.5rem);
            font-weight: 800;
            line-height: 1.1;
            margin-top: 1.5rem;
            margin-bottom: 1.25rem;
        }
        .hero-description {
            font-size: 1.125rem;
            color: rgba(241, 245, 249, 0.92);
            max-width: 720px;
            line-height: 1.7;
        }
        .hero-meta {
            display: grid;
            gap: 1rem;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            margin-top: 2.5rem;
        }
        .hero-card {
            background: rgba(15, 23, 42, 0.25);
            border: 1px solid rgba(148, 163, 184, 0.22);
            border-radius: 1rem;
            padding: 1.25rem 1.5rem;
            display: flex;
            gap: 1rem;
            align-items: flex-start;
            backdrop-filter: blur(12px);
        }
        .hero-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
            border-radius: 0.9rem;
            background: rgba(96, 165, 250, 0.25);
            color: #bfdbfe;
        }
        .hero-card h3 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.35rem;
        }
        .hero-card p {
            font-size: 0.95rem;
            color: rgba(226, 232, 240, 0.9);
            line-height: 1.55;
        }
        .progress-tracker {
            background: var(--bg-card);
            border-radius: 1.5rem;
            padding: 1.5rem;
            box-shadow: 0 25px 50px -20px rgba(30, 64, 175, 0.15);
            border: 1px solid var(--border-soft);
        }
        .progress-heading {
            display: flex;
            align-items: baseline;
            justify-content: space-between;
            gap: 1rem;
            margin-bottom: 1.25rem;
        }
        .progress-heading h2 {
            font-size: 1.25rem;
            font-weight: 700;
            color: #0f172a;
        }
        .progress-grid {
            display: grid;
            gap: 1rem;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        }
        .progress-item {
            border-radius: 1rem;
            padding: 1rem 1.25rem;
            border: 1px solid transparent;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.08), rgba(59, 130, 246, 0.02));
            display: flex;
            align-items: center;
            gap: 0.85rem;
            color: var(--text-main);
            text-decoration: none;
            transition: transform 0.25s ease, border 0.25s ease, box-shadow 0.25s ease;
        }
        .progress-item:hover {
            transform: translateY(-4px);
            border-color: rgba(59, 130, 246, 0.35);
            box-shadow: 0 12px 24px -16px rgba(37, 99, 235, 0.6);
        }
        .progress-item:focus-visible {
            outline: 2px solid rgba(37, 99, 235, 0.3);
            outline-offset: 4px;
        }
        .progress-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #2563eb;
            color: #fff;
            font-weight: 600;
            font-size: 0.95rem;
        }
        .layout-grid {
            display: grid;
            gap: 2.5rem;
        }
        @media (min-width: 1024px) {
            .layout-grid {
                grid-template-columns: 280px minmax(0, 1fr);
                align-items: start;
            }
        }
        .quick-nav {
            position: relative;
            background: var(--bg-card);
            border-radius: 1.25rem;
            padding: 1.5rem;
            border: 1px solid var(--border-soft);
            box-shadow: 0 18px 36px -24px rgba(30, 64, 175, 0.45);
        }
        .mobile-nav-toggle {
            display: none;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            gap: 0.75rem;
            margin-bottom: 1rem;
            padding: 0.85rem 1.1rem;
            border-radius: 1rem;
            border: 1px solid rgba(148, 163, 184, 0.35);
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.12), rgba(37, 99, 235, 0.05));
            color: #1d4ed8;
            font-weight: 600;
            letter-spacing: 0.01em;
            transition: border-color 0.2s ease, background 0.2s ease, box-shadow 0.2s ease;
        }
        .mobile-nav-toggle:hover {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.18), rgba(37, 99, 235, 0.08));
            border-color: rgba(37, 99, 235, 0.45);
            box-shadow: 0 15px 30px -20px rgba(37, 99, 235, 0.35);
        }
        .mobile-nav-toggle:focus-visible {
            outline: 2px solid rgba(37, 99, 235, 0.35);
            outline-offset: 4px;
        }
        .mobile-nav-toggle svg {
            width: 20px;
            height: 20px;
            color: #1e40af;
            transition: transform 0.25s ease;
        }
        .mobile-nav-toggle[aria-expanded="true"] svg {
            transform: rotate(180deg);
        }
        .table-scroll {
            position: relative;
            overflow-x: auto;
            border-radius: 0.75rem;
            -webkit-overflow-scrolling: touch;
        }
        .table-scroll::-webkit-scrollbar {
            height: 6px;
        }
        .table-scroll::-webkit-scrollbar-thumb {
            background-color: rgba(37, 99, 235, 0.25);
            border-radius: 9999px;
        }
        @media (min-width: 1024px) {
            .quick-nav {
                position: sticky;
                top: 2rem;
            }
        }
        @media (max-width: 1023px) {
            .layout-grid {
                gap: 1.75rem;
            }
            .quick-nav {
                display: none;
                padding: 1.25rem;
                box-shadow: 0 16px 35px -28px rgba(15, 23, 42, 0.35);
            }
            .quick-nav.open {
                display: block;
            }
            .mobile-nav-toggle {
                display: inline-flex;
            }
        }
        @media (max-width: 768px) {
            .hero-inner {
                padding: 4.5rem 0 3.5rem;
            }
            .hero-description {
                font-size: 1rem;
            }
            .hero-meta {
                grid-template-columns: 1fr;
            }
            .progress-tracker {
                padding: 1.25rem;
            }
            .step-card {
                padding: 1.6rem;
            }
            .chart-container {
                padding: 1.1rem;
                height: auto;
                box-sizing: border-box;
            }
            .diagram-container {
                padding: 1.1rem;
                height: auto;
                min-height: 320px;
                box-sizing: border-box;
            }
        }
        @media (max-width: 640px) {
            .container {
                padding: 1rem;
            }
            .hero-title {
                font-size: clamp(2.1rem, 9vw, 2.8rem);
            }
            .progress-heading {
                flex-direction: column;
                align-items: flex-start;
            }
            .progress-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            .step-header {
                flex-direction: column;
                align-items: flex-start;
            }
            .tab-buttons {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                padding-bottom: 0.25rem;
            }
            .tab-button {
                flex: 0 0 auto;
            }
            .diagram-container {
                min-height: 300px;
            }
        }
        .quick-nav h2 {
            font-size: 1rem;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 1rem;
        }
        .quick-nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: grid;
            gap: 0.75rem;
        }
        .quick-nav a {
            display: block;
            padding: 0.65rem 0.85rem;
            border-radius: 0.75rem;
            color: var(--text-muted);
            font-size: 0.95rem;
            font-weight: 500;
            text-decoration: none;
            transition: background 0.2s ease, color 0.2s ease;
        }
        .quick-nav a:hover,
        .quick-nav a:focus-visible {
            background: rgba(37, 99, 235, 0.08);
            color: var(--primary);
            outline: none;
        }
        .step-card {
            background-color: var(--bg-card);
            border-radius: 1.25rem;
            border: 1px solid var(--border-soft);
            box-shadow: 0 24px 48px -28px rgba(15, 23, 42, 0.45);
            padding: 2.25rem;
            margin-bottom: 2rem;
            transition: transform 0.35s ease, box-shadow 0.35s ease;
            position: relative;
        }
        .step-card::before {
            content: "";
            position: absolute;
            inset: 0;
            border-radius: inherit;
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.12), transparent 55%);
            opacity: 0;
            transition: opacity 0.35s ease;
            pointer-events: none;
        }
        .step-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 32px 60px -32px rgba(30, 64, 175, 0.5);
        }
        .step-card:hover::before {
            opacity: 1;
        }
        .step-card:target {
            box-shadow: 0 35px 70px -35px rgba(37, 99, 235, 0.65);
            border-color: rgba(37, 99, 235, 0.4);
        }
        .step-card:target::before {
            opacity: 1;
        }
        .step-header {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-main);
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e5e7eb;
            gap: 1rem;
        }
        .step-header:focus-visible {
            outline: 2px solid rgba(37, 99, 235, 0.4);
            outline-offset: 4px;
            border-radius: 0.75rem;
        }
        .step-header svg {
            color: var(--primary);
            transition: transform 0.35s ease;
        }
        .step-label {
            display: flex;
            align-items: center;
            gap: 0.85rem;
        }
        .step-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(37, 99, 235, 0.12);
            color: var(--primary);
            font-weight: 700;
            font-size: 0.95rem;
        }
        .step-title {
            font-size: 1.05rem;
            font-weight: 700;
            color: var(--text-main);
        }
        .step-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
            padding-top: 1rem;
        }
        .step-content.active {
            max-height: 5000px; /* Adjusted for full content */
            transition: max-height 0.7s ease-in;
        }
        .code-block {
            background: linear-gradient(160deg, #0f172a, #1e293b);
            color: #e5e7eb;
            padding: 1.25rem;
            border-radius: 0.85rem;
            font-family: 'Source Code Pro', monospace;
            overflow-x: auto;
            position: relative;
            border: 1px solid rgba(148, 163, 184, 0.28);
            box-shadow: 0 18px 35px -25px rgba(15, 23, 42, 0.9);
        }
        .code-block h4 {
            font-weight: 600;
            color: #cbd5f5;
            margin-bottom: 0.75rem;
            border-bottom: 1px solid rgba(148, 163, 184, 0.35);
            padding-bottom: 0.65rem;
        }
        .copy-btn {
            position: absolute;
            top: 0.85rem;
            right: 0.85rem;
            background: rgba(148, 163, 184, 0.2);
            color: #e0f2fe;
            padding: 0.35rem 0.65rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 0.75rem;
            border: 1px solid rgba(148, 163, 184, 0.2);
            transition: background 0.2s ease, color 0.2s ease;
        }
        .copy-btn:hover {
            background-color: rgba(96, 165, 250, 0.25);
            color: #bfdbfe;
        }
        .chart-container {
            width: 100%;
            height: 300px;
            margin-top: 1.5rem;
            background-color: #f9fafb;
            border-radius: 0.75rem;
            padding: 1rem;
            box-sizing: border-box;
        }
        .diagram-container {
            position: relative;
            width: 100%;
            height: 400px;
            background-color: #f9fafb;
            border-radius: 0.75rem;
            padding: 1.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            margin-top: 1.5rem;
            box-sizing: border-box;
        }
        .diagram-container svg {
            overflow: visible;
        }
        .tab-group {
            background-color: rgba(248, 250, 252, 0.85);
            border-radius: 1.25rem;
            border: 1px solid rgba(148, 163, 184, 0.25);
            padding: 1.75rem;
        }
        .tab-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }
        .tab-button {
            padding: 0.5rem 1.25rem;
            border-radius: 9999px;
            background-color: #e5e7eb;
            color: #374151;
            font-weight: 600;
            transition: background-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
        }
        .tab-button:hover {
            background-color: #d1d5db;
        }
        .tab-button.active {
            background-color: #3b82f6;
            color: #ffffff;
            box-shadow: 0 12px 25px -10px rgba(59, 130, 246, 0.6);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .info-card {
            background-color: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(148, 163, 184, 0.25);
            border-radius: 1rem;
            box-shadow: 0 20px 45px -30px rgba(30, 64, 175, 0.4);
            padding: 1.5rem;
        }
        footer {
            background: linear-gradient(135deg, #0f172a, #1e293b);
            color: #e2e8f0;
        }
        footer p {
            color: rgba(226, 232, 240, 0.85);
        }

        @media (max-width: 768px) {
            .container {
                padding: 1.25rem;
            }
            .hero-inner {
                padding: 4rem 0 3.5rem;
                gap: 2rem;
            }
            .hero-description {
                font-size: 1rem;
            }
            .hero-meta {
                grid-template-columns: 1fr;
            }
            .progress-grid {
                grid-template-columns: 1fr;
            }
            .step-card {
                padding: 1.75rem;
                margin-bottom: 1.5rem;
            }
            .step-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.75rem;
            }
            .step-header svg {
                align-self: flex-end;
            }
            .diagram-container {
                height: auto;
                min-height: 280px;
                padding: 1.25rem;
                box-sizing: border-box;
            }
            .chart-container {
                height: 260px;
                box-sizing: border-box;
            }
            .tab-buttons {
                flex-direction: column;
            }
            .tab-button {
                width: 100%;
                text-align: center;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 1rem;
            }
            .hero-title {
                font-size: clamp(2rem, 9vw, 2.75rem);
            }
            .hero-description {
                font-size: 0.95rem;
            }
            .hero-card {
                padding: 1rem 1.1rem;
            }
            .quick-nav {
                padding: 1.25rem;
            }
            .progress-item {
                align-items: flex-start;
            }
            .step-card {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body class="antialiased">

    <header class="hero">
        <div class="container hero-inner">
            <div>
                <span class="hero-badge">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 3.75L21 8.25m0 0l-4.5 4.5M21 8.25H9.75m-6 0A2.25 2.25 0 016 6h3.75v4.5H6a2.25 2.25 0 01-2.25-2.25z" />
                    </svg>
                    Panduan Site-to-Site VPN
                </span>
                <h1 class="hero-title">Panduan Lengkap Membangun Wireguard Site-to-Site dengan Mikrotik</h1>
                <p class="hero-description">Tingkatkan konektivitas antar-cabang dengan tutorial terstruktur, visualisasi jaringan, dan snippet konfigurasi yang siap pakai. Dirancang untuk engineer yang ingin hasil profesional namun tetap mudah dipahami.</p>
                <div class="hero-meta">
                    <div class="hero-card">
                        <div class="hero-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3v11.25A2.25 2.25 0 006 16.5h11.25" />
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6 16.5V6.75A2.25 2.25 0 018.25 4.5H21" />
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6 12h12.75A2.25 2.25 0 0121 14.25V21" />
                            </svg>
                        </div>
                        <div>
                            <h3>Visual & Interaktif</h3>
                            <p>Diagram D3 dan ilustrasi membantu memetakan relasi antar perangkat secara instan.</p>
                        </div>
                    </div>
                    <div class="hero-card">
                        <div class="hero-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <div>
                            <h3>Langkah Terstruktur</h3>
                            <p>Tahapan implementasi lengkap mulai dari perencanaan, deployment, hingga monitoring.</p>
                        </div>
                    </div>
                    <div class="hero-card">
                        <div class="hero-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <div>
                            <h3>Siap Produksi</h3>
                            <p>Checklist keamanan dan best practices menjaga reliabilitas koneksi antar-site.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <section class="container relative z-10 -mt-10 md:-mt-16">
        <div class="progress-tracker" aria-label="Ringkasan tahapan implementasi">
            <div class="progress-heading">
                <h2>Alur Implementasi</h2>
                <p class="text-sm text-slate-500">Klik salah satu langkah untuk melompat langsung ke pembahasan.</p>
            </div>
            <div class="progress-grid">
                <a class="progress-item" href="#langkah1">
                    <span class="progress-badge">1</span>
                    <div>
                        <p class="text-xs uppercase tracking-widest text-slate-500">Langkah 01</p>
                        <p class="font-semibold text-slate-900">Pengenalan & manfaat</p>
                    </div>
                </a>
                <a class="progress-item" href="#langkah2">
                    <span class="progress-badge">2</span>
                    <div>
                        <p class="text-xs uppercase tracking-widest text-slate-500">Langkah 02</p>
                        <p class="font-semibold text-slate-900">Persiapan jaringan</p>
                    </div>
                </a>
                <a class="progress-item" href="#langkah3">
                    <span class="progress-badge">3</span>
                    <div>
                        <p class="text-xs uppercase tracking-widest text-slate-500">Langkah 03</p>
                        <p class="font-semibold text-slate-900">Setup VPS Wireguard</p>
                    </div>
                </a>
                <a class="progress-item" href="#langkah4">
                    <span class="progress-badge">4</span>
                    <div>
                        <p class="text-xs uppercase tracking-widest text-slate-500">Langkah 04</p>
                        <p class="font-semibold text-slate-900">Konfigurasi perangkat</p>
                    </div>
                </a>
                <a class="progress-item" href="#langkah5">
                    <span class="progress-badge">5</span>
                    <div>
                        <p class="text-xs uppercase tracking-widest text-slate-500">Langkah 05</p>
                        <p class="font-semibold text-slate-900">Testing & troubleshooting</p>
                    </div>
                </a>
                <a class="progress-item" href="#langkah6">
                    <span class="progress-badge">6</span>
                    <div>
                        <p class="text-xs uppercase tracking-widest text-slate-500">Langkah 06</p>
                        <p class="font-semibold text-slate-900">Optimisasi lanjutan</p>
                    </div>
                </a>
            </div>
        </div>
    </section>

    <main class="container mt-14">
        <button class="mobile-nav-toggle" type="button" data-mobile-nav-toggle aria-controls="quickNav" aria-expanded="false">
            <span>Navigasi Cepat</span>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.8" stroke="currentColor" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M5 9l7 7 7-7" />
            </svg>
        </button>
        <div class="layout-grid">
            <aside id="quickNav" class="quick-nav" aria-label="Navigasi cepat" role="navigation">
                <h2>Navigasi Cepat</h2>
                <ul>
                    <li><a href="#langkah1">Pengenalan &amp; manfaat Wireguard</a></li>
                    <li><a href="#langkah2">Persiapan dan perencanaan jaringan</a></li>
                    <li><a href="#langkah3">Setup VPS dan wg-easy</a></li>
                    <li><a href="#langkah4">Konfigurasi Mikrotik &amp; client</a></li>
                    <li><a href="#langkah5">Testing, monitoring &amp; troubleshooting</a></li>
                    <li><a href="#langkah6">Optimisasi dan best practices</a></li>
                </ul>
            </aside>

            <div class="space-y-8">

        <!-- Pengenalan -->
        <section class="step-card" id="langkah1">
            <div class="step-header" onclick="toggleSection('intro', this)" onkeydown="handleStepKey(event, 'intro', this)" role="button" tabindex="0" aria-expanded="true" aria-controls="content-intro" data-step-toggle="intro">
                <div class="step-label">
                    <span class="step-badge">1</span>
                    <span class="step-title">Pengenalan Wireguard dan Manfaatnya</span>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6 transform transition-transform duration-300 rotate-180" id="icon-intro">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                </svg>
            </div>
            <div class="step-content active" id="content-intro" aria-hidden="false">
                <p class="mb-4">Wireguard adalah protokol VPN modern yang dirancang untuk menjadi sederhana, cepat, dan aman. Keunggulannya meliputi **performance superior**, **konfigurasi yang sederhana**, dan **cryptography modern**.</p>
                <div class="diagram-container">
                    <h4 class="font-semibold mb-4 text-center text-lg">Perbandingan Wireguard vs. VPN Tradisional</h4>
                    <svg id="vpn-comparison" width="100%" height="100%" viewBox="0 0 800 300"></svg>
                </div>
                <div class="mt-4 prose max-w-none">
                    <h3>Apa Itu Wireguard?</h3>
                    <p>Wireguard adalah protokol VPN modern yang dirancang untuk menjadi sederhana, cepat, dan aman. Dikembangkan sebagai alternatif yang lebih efisien dibanding protokol VPN tradisional seperti IPSec atau OpenVPN, Wireguard menggunakan kriptografi modern dengan overhead yang minimal.</p>
                    <h3>Mengapa Diperlukan?</h3>
                    <p>Dalam era digital saat ini, banyak organisasi memiliki multiple lokasi yang memerlukan konektivitas aman antar-jaringan. Tantangan umum yang dihadapi:</p>
                    <ul class="list-disc ml-6">
                        <li><strong>Keterbatasan IP Publik</strong>: Provider internet residential (seperti Indihome) tidak menyediakan IP publik static</li>
                        <li><strong>Biaya Dedicated Line</strong>: Koneksi MPLS atau dedicated line memiliki biaya tinggi</li>
                        <li><strong>Keamanan Internet</strong>: Traffic antar-lokasi melalui internet publik memerlukan enkripsi</li>
                        <li><strong>Kompleksitas Konfigurasi</strong>: Protokol VPN tradisional memerlukan setup yang rumit</li>
                        <li><strong>Maintenance Overhead</strong>: Solusi proprietary memerlukan maintenance khusus</li>
                    </ul>
                    <div class="mt-6 bg-blue-50 border border-blue-100 rounded-xl p-5 shadow-sm">
                        <div class="flex items-start gap-3">
                            <div class="flex h-10 w-10 items-center justify-center rounded-full bg-blue-100 text-blue-600">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.75-11.75a.75.75 0 00-1.5 0v3.5c0 .414.336.75.75.75h2.5a.75.75 0 000-1.5H10.75V6.25z" clip-rule="evenodd" />
                                </svg>
                            </div>
                            <p class="text-gray-700 text-base leading-relaxed">Bayangkan Wireguard seperti jalur tol privat yang dibangun di atas jalan raya publik. Ia memotong kemacetan konfigurasi VPN tradisional dengan rute yang lebih lurus, sehingga data antar-kantor melaju cepat tanpa mengorbankan keamanan.</p>
                        </div>
                    </div>
                    <div class="mt-8 grid gap-6 md:grid-cols-3">
                        <div class="rounded-xl border border-slate-200 bg-white/80 p-5 shadow-sm">
                            <h4 class="mb-3 flex items-center gap-2 text-lg font-semibold text-blue-600">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m6-6H6" />
                                </svg>
                                Manfaat Wireguard untuk Site-to-Site VPN
                            </h4>
                            <ul class="list-disc space-y-2 pl-5 text-sm text-gray-700">
                                <li><strong>Throughput tinggi</strong> dengan penggunaan CPU minimal sehingga koneksi antar-site tetap responsif.</li>
                                <li><strong>Konfigurasi sederhana</strong>; cukup beberapa baris file konfigurasi untuk membangun terowongan.</li>
                                <li><strong>Kriptografi modern</strong> seperti ChaCha20 dan Poly1305 menjaga kerahasiaan data.</li>
                                <li><strong>Dukungan roaming</strong> memastikan terowongan tetap hidup saat IP berubah.</li>
                            </ul>
                        </div>
                        <div class="rounded-xl border border-slate-200 bg-white/80 p-5 shadow-sm">
                            <h4 class="mb-3 flex items-center gap-2 text-lg font-semibold text-emerald-600">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 7.5l4.5 4.5L3 16.5m6-9l4.5 4.5L9 16.5m6-9l4.5 4.5L15 16.5" />
                                </svg>
                                Potensi Manfaat Implementasi
                            </h4>
                            <ul class="list-disc space-y-2 pl-5 text-sm text-gray-700">
                                <li><strong>Unified network</strong> yang membuat tiap cabang terasa seperti satu LAN besar.</li>
                                <li><strong>Akses terpusat</strong> untuk file server, database, dan aplikasi internal dari mana saja.</li>
                                <li><strong>Dukungan remote work</strong> dan replikasi data antar-lokasi untuk skenario pemulihan bencana.</li>
                                <li><strong>Efisiensi biaya</strong> karena memanfaatkan koneksi internet existing dan VPS terjangkau.</li>
                            </ul>
                        </div>
                        <div class="rounded-xl border border-slate-200 bg-white/80 p-5 shadow-sm">
                            <h4 class="mb-3 flex items-center gap-2 text-lg font-semibold text-amber-600">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m0 3.75h.008v.008H12v-.008zM21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                                Kendala yang Dijembatani Wireguard
                            </h4>
                            <ul class="list-disc space-y-2 pl-5 text-sm text-gray-700">
                                <li><strong>NAT traversal</strong> diatasi dengan memanfaatkan VPS sebagai titik temu UDP.</li>
                                <li><strong>Dynamic IP</strong> tidak lagi jadi masalah berkat kemampuan endpoint discovery otomatis.</li>
                                <li><strong>Firewall kompleks</strong> disederhanakan karena hanya butuh satu port UDP 51820.</li>
                                <li><strong>Bottleneck performa</strong> berkurang dengan implementasi kernel-space dan overhead minimal.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Perencanaan Jaringan -->
        <section class="step-card" id="langkah2">
            <div class="step-header" onclick="toggleSection('planning', this)" onkeydown="handleStepKey(event, 'planning', this)" role="button" tabindex="0" aria-expanded="false" aria-controls="content-planning" data-step-toggle="planning">
                <div class="step-label">
                    <span class="step-badge">2</span>
                    <span class="step-title">Persiapan dan Perencanaan Jaringan</span>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6 transform transition-transform duration-300 rotate-0" id="icon-planning">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                </svg>
            </div>
            <div class="step-content" id="content-planning" aria-hidden="true">
                <p class="mb-4">Tahap ini penting untuk memastikan tidak ada konflik IP dan koneksi dapat terhubung dengan baik.</p>
                <div class="diagram-container">
                    <h4 class="font-semibold mb-4 text-center text-lg">Diagram Topologi VPN Site-to-Site</h4>
                    <svg id="network-topology" width="100%" height="100%" viewBox="0 0 800 400"></svg>
                </div>
                <div class="mt-4 prose max-w-none">
                    <h3>Langkah 1: Inventarisasi Hardware Existing</h3>
                    <h4>A. Survey Mikrotik di Setiap Lokasi</h4>
                    <p><strong>Informasi yang Harus Dikumpulkan:</strong> Model, versi RouterOS (harus v7.x), CPU, RAM, interface, dan konfigurasi IP saat ini.</p>
                    <div class="code-block">
                        <h4>Command untuk Inventarisasi di Mikrotik</h4>
                        <pre><code><span id="code-mikrotik-inventory">/system resource print
/system package print
/interface print
/ip address print
/ip route print
/ip dhcp-server print
/ip firewall filter print</span></code></pre>
                        <button class="copy-btn" onclick="copyCode('code-mikrotik-inventory')">Salin</button>
                    </div>
                    <h4>B. Survey Router ISP di Setiap Lokasi</h4>
                    <p>Informasi yang diperlukan: Brand/Model, IP WAN, DHCP Range, dan Port Forwarding.</p>
                    <div class="code-block">
                        <h4>Cara Mengakses Router ISP</h4>
                        <pre><code><span id="code-isp-router"># Cek gateway default
ipconfig /all    # Windows
ip route show    # Linux</span></code></pre>
                        <button class="copy-btn" onclick="copyCode('code-isp-router')">Salin</button>
                    </div>
                    <h3>Langkah 2: Inventarisasi VPS/Cloud Server</h3>
                    <p>Pastikan VPS Anda memenuhi persyaratan minimum dan memiliki port yang diperlukan terbuka.</p>
                    <h3>Langkah 3: Planning IP Address Scheme</h3>
                    <p>Rencanakan subnet untuk jaringan Wireguard dan jaringan lokal di setiap lokasi untuk menghindari konflik.</p>
                    <h3>Langkah 4: Dokumentasi Pre-Implementation</h3>
                    <p>Buat diagram jaringan, checklist implementasi, dan rencana rollback untuk mempersiapkan diri.</p>
                </div>
            </div>
        </section>

        <!-- Setup VPS -->
        <section class="step-card" id="langkah3">
            <div class="step-header" onclick="toggleSection('vps-setup', this)" onkeydown="handleStepKey(event, 'vps-setup', this)" role="button" tabindex="0" aria-expanded="false" aria-controls="content-vps-setup" data-step-toggle="vps-setup">
                <div class="step-label">
                    <span class="step-badge">3</span>
                    <span class="step-title">Setup VPS Wireguard (wg-easy)</span>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6 transform transition-transform duration-300 rotate-0" id="icon-vps-setup">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                </svg>
            </div>
            <div class="step-content" id="content-vps-setup" aria-hidden="true">
                <p class="mb-4">Instalasi Docker dan wg-easy untuk manajemen server Wireguard yang mudah.</p>
                <div class="prose max-w-none">
                    <h3>Langkah 1: Persiapan VPS</h3>
                    <h4>A. Initial Server Setup</h4>
                    <div class="code-block">
                        <h4>Command Instalasi dan Keamanan</h4>
                        <pre><code><span id="code-vps-initial">apt update && apt upgrade -y
apt install -y curl wget htop nano ufw fail2ban
ufw allow ssh
ufw allow 51820/udp
ufw allow 51821/tcp
ufw --force enable</span></code></pre>
                        <button class="copy-btn" onclick="copyCode('code-vps-initial')">Salin</button>
                    </div>
                    <h4>B. Docker Installation</h4>
                    <div class="code-block">
                        <h4>Command Instalasi Docker</h4>
                        <pre><code><span id="code-docker-install">curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh
curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose</span></code></pre>
                        <button class="copy-btn" onclick="copyCode('code-docker-install')">Salin</button>
                    </div>
                    <h3>Langkah 2: Konfigurasi wg-easy</h3>
                    <div class="code-block">
                        <h4>A. Docker Compose Configuration</h4>
                        <pre><code><span id="code-vps-setup">version: '3.8'

services:
  wg-easy:
    environment:
      - WG_HOST=your-domain.com
      - PASSWORD=YourSecurePassword123!
      - WG_PORT=51820
      - WG_DEFAULT_ADDRESS=10.8.0.x
    image: ghcr.io/wg-easy/wg-easy:15
    container_name: wg-easy
    ports:
      - "51820:51820/udp"
      - "51821:51821/tcp"
    restart: unless-stopped
    cap_add:
      - NET_ADMIN
      - SYS_MODULE
    sysctls:
      - net.ipv4.ip_forward=1</span></code></pre>
                        <button class="copy-btn" onclick="copyCode('code-vps-setup')">Salin</button>
                    </div>
                    <h3>Langkah 3: Deployment dan Testing</h3>
                    <div class="code-block">
                        <h4>Command untuk Deployment</h4>
                        <pre><code><span id="code-vps-deploy">cd /opt/wireguard
docker-compose up -d
docker-compose ps
docker-compose logs -f</span></code></pre>
                        <button class="copy-btn" onclick="copyCode('code-vps-deploy')">Salin</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Konfigurasi Client & Mikrotik -->
        <section class="step-card" id="langkah4">
            <div class="step-header" onclick="toggleSection('mikrotik-config', this)" onkeydown="handleStepKey(event, 'mikrotik-config', this)" role="button" tabindex="0" aria-expanded="false" aria-controls="content-mikrotik-config" data-step-toggle="mikrotik-config">
                <div class="step-label">
                    <span class="step-badge">4</span>
                    <span class="step-title">Konfigurasi Client &amp; Mikrotik</span>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6 transform transition-transform duration-300 rotate-0" id="icon-mikrotik-config">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                </svg>
            </div>
            <div class="step-content" id="content-mikrotik-config" aria-hidden="true">
                <p class="mb-6 text-gray-700">Gunakan panduan ini untuk menyelaraskan konfigurasi client di wg-easy dengan dua perangkat Mikrotik sehingga kedua lokasi dapat saling berkomunikasi secara aman.</p>
                <div class="tab-group" data-tab-group="mikrotik">
                    <div class="tab-buttons">
                        <button class="tab-button active" data-tab="client">Konfigurasi Client di wg-easy</button>
                        <button class="tab-button" data-tab="lokasi1">Konfigurasi Mikrotik Lokasi Pertama</button>
                        <button class="tab-button" data-tab="lokasi2">Konfigurasi Mikrotik Lokasi Kedua</button>
                    </div>

                    <div class="tab-content active space-y-8" data-tab-content="client" id="tab-client">
                        <div>
                            <h3 class="text-xl font-semibold text-blue-600 mb-3">Langkah 1: Akses Dashboard wg-easy</h3>
                            <ol class="list-decimal ml-6 space-y-2 text-gray-700">
                                <li>Buka <code>http://[VPS_IP]:51821</code> di browser Anda.</li>
                                <li>Masukkan password administrator yang didefinisikan pada <code>docker-compose.yml</code>.</li>
                                <li>Pastikan dashboard menampilkan interface <strong>wg0</strong> dengan daftar client kosong atau sesuai kebutuhan.</li>
                            </ol>
                        </div>

                        <div>
                            <h3 class="text-xl font-semibold text-blue-600 mb-3">Langkah 2: Membuat Client untuk Tiap Lokasi</h3>
                            <div class="grid gap-6 md:grid-cols-2">
                                <div class="info-card">
                                    <h4 class="text-lg font-semibold text-gray-800 mb-2">Client Lokasi Pertama</h4>
                                    <ol class="list-decimal ml-6 space-y-2 text-sm text-gray-700">
                                        <li>Klik tombol <strong>Add Client</strong>.</li>
                                        <li>Isi nama <strong>Lokasi-Utama</strong>; IP akan otomatis diberikan (umumnya <code>10.8.0.2</code>).</li>
                                        <li>Tekan <strong>Create</strong> dan pastikan client muncul di daftar.</li>
                                    </ol>
                                </div>
                                <div class="info-card">
                                    <h4 class="text-lg font-semibold text-gray-800 mb-2">Client Lokasi Kedua</h4>
                                    <ol class="list-decimal ml-6 space-y-2 text-sm text-gray-700">
                                        <li>Pilih <strong>Add Client</strong> sekali lagi.</li>
                                        <li>Masukkan nama <strong>Lokasi-Cabang</strong>; IP biasanya <code>10.8.0.4</code>.</li>
                                        <li>Tekan <strong>Create</strong> untuk menyimpan client kedua.</li>
                                    </ol>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h3 class="text-xl font-semibold text-blue-600 mb-3">Langkah 3: Atur Allowed IPs</h3>
                            <p class="text-gray-700 mb-4">Edit masing-masing client dan ikuti daftar bertahap berikut untuk memastikan rute site-to-site tersusun dengan benar.</p>
                            <div class="grid gap-6 md:grid-cols-2">
                                <div class="info-card space-y-4">
                                    <h4 class="text-lg font-semibold text-blue-600">Client Lokasi-Utama</h4>
                                    <ol class="list-decimal ml-6 space-y-2 text-sm text-gray-700">
                                        <li>Klik ikon <strong>Edit</strong> (pensil).</li>
                                        <li>Pada <strong>Allowed IPs</strong>, isi nilai berikut.</li>
                                        <li>Di bagian <strong>Server Allowed IPs</strong>, masukkan subnet LAN lokasi utama.</li>
                                        <li>Pilih <strong>Save</strong> untuk menyimpan perubahan.</li>
                                    </ol>
                                    <div class="grid gap-3 md:grid-cols-2">
                                        <div class="code-block">
                                            <h4>Allowed IPs</h4>
                                            <pre><code><span id="code-allowed-lokasi1">10.8.0.0/24</span></code></pre>
                                            <button class="copy-btn" onclick="copyCode('code-allowed-lokasi1')">Salin</button>
                                        </div>
                                        <div class="code-block">
                                            <h4>Server Allowed IPs</h4>
                                            <pre><code><span id="code-server-allowed-lokasi1">192.168.110.0/24</span></code></pre>
                                            <button class="copy-btn" onclick="copyCode('code-server-allowed-lokasi1')">Salin</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-card space-y-4">
                                    <h4 class="text-lg font-semibold text-blue-600">Client Lokasi-Cabang</h4>
                                    <ol class="list-decimal ml-6 space-y-2 text-sm text-gray-700">
                                        <li>Klik ikon <strong>Edit</strong> pada client.</li>
                                        <li>Isi <strong>Allowed IPs</strong> dengan network Wireguard.</li>
                                        <li>Set <strong>Server Allowed IPs</strong> ke subnet LAN lokasi cabang.</li>
                                        <li>Simpan perubahan dengan menekan <strong>Save</strong>.</li>
                                    </ol>
                                    <div class="grid gap-3 md:grid-cols-2">
                                        <div class="code-block">
                                            <h4>Allowed IPs</h4>
                                            <pre><code><span id="code-allowed-lokasi2">10.8.0.0/24</span></code></pre>
                                            <button class="copy-btn" onclick="copyCode('code-allowed-lokasi2')">Salin</button>
                                        </div>
                                        <div class="code-block">
                                            <h4>Server Allowed IPs</h4>
                                            <pre><code><span id="code-server-allowed-lokasi2">192.168.113.0/24</span></code></pre>
                                            <button class="copy-btn" onclick="copyCode('code-server-allowed-lokasi2')">Salin</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h3 class="text-xl font-semibold text-blue-600 mb-3">Langkah 4: Unduh dan Audit Konfigurasi</h3>
                            <div class="grid gap-6 md:grid-cols-2">
                                <div class="info-card space-y-3">
                                    <h4 class="text-lg font-semibold text-gray-800">Config Lokasi Pertama</h4>
                                    <ol class="list-decimal ml-6 space-y-2 text-sm text-gray-700">
                                        <li>Klik ikon <strong>Download</strong> pada client <strong>Lokasi-Utama</strong>.</li>
                                        <li>Simpan sebagai <code>lokasi-utama.conf</code> dan catat nilai penting berikut.</li>
                                    </ol>
                                    <div class="code-block">
                                        <h4>Potongan Konfigurasi</h4>
                                        <pre><code><span id="code-config-lokasi1">[Interface]
PrivateKey = [PRIVATE_KEY_LOKASI_UTAMA]
Address = 10.8.0.2/24

[Peer]
PublicKey = [SERVER_PUBLIC_KEY]
PresharedKey = [PRESHARED_KEY_LOKASI_UTAMA]
Endpoint = your-domain.com:51820
AllowedIPs = 10.8.0.0/24, 192.168.113.0/24</span></code></pre>
                                        <button class="copy-btn" onclick="copyCode('code-config-lokasi1')">Salin</button>
                                    </div>
                                </div>
                                <div class="info-card space-y-3">
                                    <h4 class="text-lg font-semibold text-gray-800">Config Lokasi Kedua</h4>
                                    <ol class="list-decimal ml-6 space-y-2 text-sm text-gray-700">
                                        <li>Download client <strong>Lokasi-Cabang</strong> sebagai <code>lokasi-cabang.conf</code>.</li>
                                        <li>Pastikan detail berikut tersimpan.</li>
                                    </ol>
                                    <div class="code-block">
                                        <h4>Potongan Konfigurasi</h4>
                                        <pre><code><span id="code-config-lokasi2">[Interface]
PrivateKey = [PRIVATE_KEY_LOKASI_CABANG]
Address = 10.8.0.4/24

[Peer]
PublicKey = [SERVER_PUBLIC_KEY]
PresharedKey = [PRESHARED_KEY_LOKASI_CABANG]
Endpoint = your-domain.com:51820
AllowedIPs = 10.8.0.0/24, 192.168.110.0/24</span></code></pre>
                                        <button class="copy-btn" onclick="copyCode('code-config-lokasi2')">Salin</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h3 class="text-xl font-semibold text-blue-600 mb-3">Langkah 5: Verifikasi dari VPS</h3>
                            <p class="text-gray-700 mb-3">Gunakan perintah berikut untuk memastikan kedua client tercatat dan Allowed IPs sudah benar.</p>
                            <div class="code-block">
                                <h4>Verifikasi Peer di wg-easy</h4>
                                <pre><code><span id="code-wg-show">docker exec wg-easy wg show

# Output yang diharapkan:
# peer: [PUBLIC_KEY_LOKASI_UTAMA]
#   allowed ips: 10.8.0.2/32, 192.168.110.0/24
# peer: [PUBLIC_KEY_LOKASI_CABANG]
#   allowed ips: 10.8.0.4/32, 192.168.113.0/24</span></code></pre>
                                <button class="copy-btn" onclick="copyCode('code-wg-show')">Salin</button>
                            </div>
                        </div>
                    </div>

                    <div class="tab-content space-y-8" data-tab-content="lokasi1" id="tab-lokasi1">
                        <div class="space-y-6 text-gray-700">
                            <div>
                                <h3 class="text-xl font-semibold text-blue-600 mb-3">Langkah 1: Backup &amp; Validasi Router</h3>
                                <p class="mb-3">Sebelum melakukan perubahan, backup konfigurasi existing dan cek kesiapan perangkat.</p>
                                <div class="code-block mb-4">
                                    <h4>Backup Konfigurasi</h4>
                                    <pre><code><span id="code-backup-lokasi1">/export file=backup-pre-wireguard-lokasi1
/certificate export-certificate numbers=0,1,2,3</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-backup-lokasi1')">Salin</button>
                                </div>
                                <div class="code-block">
                                    <h4>Verifikasi Sistem</h4>
                                    <pre><code><span id="code-verify-sistem-lokasi1">/system resource print
/interface print
/ip route print</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-verify-sistem-lokasi1')">Salin</button>
                                </div>
                            </div>

                            <div>
                                <h3 class="text-xl font-semibold text-blue-600 mb-3">Langkah 2: Buat Interface Wireguard</h3>
                                <ol class="list-decimal ml-6 space-y-2">
                                    <li>Tambahkan interface Wireguard baru dengan private key dari file <code>lokasi-utama.conf</code>.</li>
                                    <li>Assign IP <code>10.8.0.2/24</code> ke interface tersebut.</li>
                                    <li>Verifikasi interface dan IP sudah aktif.</li>
                                </ol>
                                <div class="grid gap-4 md:grid-cols-3 mt-4">
                                    <div class="code-block">
                                        <h4>Tambah Interface</h4>
                                        <pre><code><span id="code-interface-lokasi1">/interface wireguard add listen-port=51820 mtu=1420 name=wg-site2site private-key="[PRIVATE_KEY_DARI_CONFIG_LOKASI_UTAMA]"</span></code></pre>
                                        <button class="copy-btn" onclick="copyCode('code-interface-lokasi1')">Salin</button>
                                    </div>
                                    <div class="code-block">
                                        <h4>Assign IP</h4>
                                        <pre><code><span id="code-ip-lokasi1">/ip address add address=10.8.0.2/24 interface=wg-site2site comment="Wireguard-Site2Site-IP"</span></code></pre>
                                        <button class="copy-btn" onclick="copyCode('code-ip-lokasi1')">Salin</button>
                                    </div>
                                    <div class="code-block">
                                        <h4>Verifikasi</h4>
                                        <pre><code><span id="code-verify-interface-lokasi1">/interface wireguard print
/ip address print where interface=wg-site2site</span></code></pre>
                                        <button class="copy-btn" onclick="copyCode('code-verify-interface-lokasi1')">Salin</button>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <h3 class="text-xl font-semibold text-blue-600 mb-3">Langkah 3: Tambahkan Peer ke VPS</h3>
                                <p class="mb-3">Gunakan public key VPS dan preshared key dari konfigurasi wg-easy.</p>
                                <div class="code-block">
                                    <h4>Konfigurasi Peer</h4>
                                    <pre><code><span id="code-peer-lokasi1">/interface wireguard peers add allowed-address=0.0.0.0/0,::/0 endpoint-address=your-domain.com endpoint-port=51820 interface=wg-site2site public-key="[SERVER_PUBLIC_KEY]" preshared-key="[PRESHARED_KEY_LOKASI_UTAMA]" persistent-keepalive=25s comment="VPS-Server"</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-peer-lokasi1')">Salin</button>
                                </div>
                                <div class="code-block mt-4">
                                    <h4>Verifikasi Peer</h4>
                                    <pre><code><span id="code-verify-peer-lokasi1">/interface wireguard peers print detail</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-verify-peer-lokasi1')">Salin</button>
                                </div>
                            </div>

                            <div>
                                <h3 class="text-xl font-semibold text-blue-600 mb-3">Langkah 4: Routing</h3>
                                <ol class="list-decimal ml-6 space-y-2">
                                    <li>Buat rute ke subnet lokasi cabang.</li>
                                    <li>Tambahkan rute ke network manajemen Wireguard.</li>
                                    <li>Pastikan tabel routing sudah memuat entri baru.</li>
                                </ol>
                                <div class="grid gap-4 md:grid-cols-3 mt-4">
                                    <div class="code-block">
                                        <h4>Route ke Cabang</h4>
                                        <pre><code><span id="code-route-lokasi1">/ip route add dst-address=192.168.113.0/24 gateway=wg-site2site distance=1 comment="to-Lokasi-Cabang-via-Wireguard"</span></code></pre>
                                        <button class="copy-btn" onclick="copyCode('code-route-lokasi1')">Salin</button>
                                    </div>
                                    <div class="code-block">
                                        <h4>Route Manajemen</h4>
                                        <pre><code><span id="code-route-wg-lokasi1">/ip route add dst-address=10.8.0.0/24 gateway=wg-site2site distance=1 comment="Wireguard-Management-Network"</span></code></pre>
                                        <button class="copy-btn" onclick="copyCode('code-route-wg-lokasi1')">Salin</button>
                                    </div>
                                    <div class="code-block">
                                        <h4>Verifikasi Routing</h4>
                                        <pre><code><span id="code-verify-route-lokasi1">/ip route print where gateway=wg-site2site</span></code></pre>
                                        <button class="copy-btn" onclick="copyCode('code-verify-route-lokasi1')">Salin</button>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <h3 class="text-xl font-semibold text-blue-600 mb-3">Langkah 5: Firewall &amp; NAT</h3>
                                <p class="mb-3">Buka akses yang diperlukan sambil tetap menjaga rule existing.</p>
                                <div class="code-block">
                                    <h4>Rule Firewall Wireguard</h4>
                                    <pre><code><span id="code-firewall-lokasi1">/ip firewall filter add action=accept chain=forward connection-state=established,related comment="allow-established-related" place-before=0
/ip firewall filter add action=accept chain=forward in-interface=wg-site2site comment="allow-from-wireguard" place-before=0
/ip firewall filter add action=accept chain=forward out-interface=wg-site2site comment="allow-to-wireguard" place-before=0
/ip firewall filter add action=accept chain=input in-interface=wg-site2site comment="allow-wg-to-router" place-before=0
/ip firewall nat add action=accept chain=srcnat src-address=10.8.0.0/24 comment="bypass-nat-for-wireguard" place-before=0</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-firewall-lokasi1')">Salin</button>
                                </div>
                            </div>

                            <div>
                                <h3 class="text-xl font-semibold text-blue-600 mb-3">Langkah 6: Testing Awal</h3>
                                <div class="code-block">
                                    <h4>Ping &amp; Status</h4>
                                    <pre><code><span id="code-test-lokasi1">/ping 10.8.0.1 count=5
/interface wireguard print</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-test-lokasi1')">Salin</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-content space-y-8" data-tab-content="lokasi2" id="tab-lokasi2">
                        <div class="space-y-6 text-gray-700">
                            <div>
                                <h3 class="text-xl font-semibold text-blue-600 mb-3">Langkah 1: Backup &amp; Validasi Router Lokasi Kedua</h3>
                                <p class="mb-3">Ulangi prosedur backup sebelum melakukan perubahan di cabang.</p>
                                <div class="code-block">
                                    <h4>Backup Konfigurasi</h4>
                                    <pre><code><span id="code-backup-lokasi2">/export file=backup-pre-wireguard-lokasi2</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-backup-lokasi2')">Salin</button>
                                </div>
                                <div class="code-block mt-4">
                                    <h4>Verifikasi Sistem</h4>
                                    <pre><code><span id="code-verify-sistem-lokasi2">/system resource print
/interface print</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-verify-sistem-lokasi2')">Salin</button>
                                </div>
                            </div>

                            <div>
                                <h3 class="text-xl font-semibold text-blue-600 mb-3">Langkah 2: Interface &amp; IP Wireguard</h3>
                                <ol class="list-decimal ml-6 space-y-2">
                                    <li>Gunakan private key dari <code>lokasi-cabang.conf</code> untuk membuat interface.</li>
                                    <li>Pasangkan alamat <code>10.8.0.4/24</code> ke interface Wireguard.</li>
                                </ol>
                                <div class="grid gap-4 md:grid-cols-3 mt-4">
                                    <div class="code-block">
                                        <h4>Tambah Interface</h4>
                                        <pre><code><span id="code-interface-lokasi2">/interface wireguard add listen-port=51820 mtu=1420 name=wg-site2site private-key="[PRIVATE_KEY_DARI_CONFIG_LOKASI_CABANG]"</span></code></pre>
                                        <button class="copy-btn" onclick="copyCode('code-interface-lokasi2')">Salin</button>
                                    </div>
                                    <div class="code-block">
                                        <h4>Assign IP</h4>
                                        <pre><code><span id="code-ip-lokasi2">/ip address add address=10.8.0.4/24 interface=wg-site2site comment="Wireguard-Site2Site-IP"</span></code></pre>
                                        <button class="copy-btn" onclick="copyCode('code-ip-lokasi2')">Salin</button>
                                    </div>
                                    <div class="code-block">
                                        <h4>Verifikasi</h4>
                                        <pre><code><span id="code-verify-interface-lokasi2">/interface wireguard print
/ip address print where interface=wg-site2site</span></code></pre>
                                        <button class="copy-btn" onclick="copyCode('code-verify-interface-lokasi2')">Salin</button>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <h3 class="text-xl font-semibold text-blue-600 mb-3">Langkah 3: Peer &amp; Routing</h3>
                                <p class="mb-3">Sesuaikan endpoint sama seperti lokasi pertama, namun gunakan preshared key dari client cabang.</p>
                                <div class="code-block">
                                    <h4>Konfigurasi Peer</h4>
                                    <pre><code><span id="code-peer-lokasi2">/interface wireguard peers add allowed-address=0.0.0.0/0,::/0 endpoint-address=your-domain.com endpoint-port=51820 interface=wg-site2site public-key="[SERVER_PUBLIC_KEY]" preshared-key="[PRESHARED_KEY_LOKASI_CABANG]" persistent-keepalive=25s comment="VPS-Server"</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-peer-lokasi2')">Salin</button>
                                </div>
                                <div class="grid gap-4 md:grid-cols-2 mt-4">
                                    <div class="code-block">
                                        <h4>Routing ke Lokasi Utama</h4>
                                        <pre><code><span id="code-route-lokasi2">/ip route add dst-address=192.168.110.0/24 gateway=wg-site2site distance=1 comment="to-Lokasi-Utama-via-Wireguard"</span></code></pre>
                                        <button class="copy-btn" onclick="copyCode('code-route-lokasi2')">Salin</button>
                                    </div>
                                    <div class="code-block">
                                        <h4>Routing Network Wireguard</h4>
                                        <pre><code><span id="code-route-wg-lokasi2">/ip route add dst-address=10.8.0.0/24 gateway=wg-site2site distance=1 comment="Wireguard-Management-Network"</span></code></pre>
                                        <button class="copy-btn" onclick="copyCode('code-route-wg-lokasi2')">Salin</button>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <h3 class="text-xl font-semibold text-blue-600 mb-3">Langkah 4: Firewall &amp; NAT</h3>
                                <p class="mb-3">Gunakan rule identik seperti lokasi pertama untuk memastikan trafik dapat melewati terowongan.</p>
                                <div class="code-block">
                                    <h4>Rule Firewall Cabang</h4>
                                    <pre><code><span id="code-firewall-lokasi2">/ip firewall filter add action=accept chain=forward connection-state=established,related comment="allow-established-related" place-before=0
/ip firewall filter add action=accept chain=forward in-interface=wg-site2site comment="allow-from-wireguard" place-before=0
/ip firewall filter add action=accept chain=forward out-interface=wg-site2site comment="allow-to-wireguard" place-before=0
/ip firewall filter add action=accept chain=input in-interface=wg-site2site comment="allow-wg-to-router" place-before=0
/ip firewall nat add action=accept chain=srcnat src-address=10.8.0.0/24 comment="bypass-nat-for-wireguard" place-before=0</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-firewall-lokasi2')">Salin</button>
                                </div>
                            </div>

                            <div>
                                <h3 class="text-xl font-semibold text-blue-600 mb-3">Langkah 5: Testing</h3>
                                <div class="code-block">
                                    <h4>Uji Konektivitas</h4>
                                    <pre><code><span id="code-test-lokasi2">/ping 10.8.0.1 count=5
/ping 10.8.0.2 count=5</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-test-lokasi2')">Salin</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Monitoring & Troubleshooting -->
        <section class="step-card" id="langkah5">
            <div class="step-header" onclick="toggleSection('troubleshooting', this)" onkeydown="handleStepKey(event, 'troubleshooting', this)" role="button" tabindex="0" aria-expanded="false" aria-controls="content-troubleshooting" data-step-toggle="troubleshooting">
                <div class="step-label">
                    <span class="step-badge">5</span>
                    <span class="step-title">Testing, Monitoring &amp; Troubleshooting</span>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6 transform transition-transform duration-300 rotate-0" id="icon-troubleshooting">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                </svg>
            </div>
            <div class="step-content" id="content-troubleshooting" aria-hidden="true">
                <p class="mb-4">Lakukan pengujian konektivitas secara menyeluruh dan pantau performa jaringan.</p>
                <div class="chart-container">
                    <h4 class="font-semibold mb-2 text-center">Simulasi Latensi VPN (ms)</h4>
                    <svg id="latency-chart"></svg>
                </div>
                <div class="mt-4 prose max-w-none">
                    <h3>Testing dan Verifikasi</h3>
                    <p>Lakukan uji berlapis untuk memastikan konektivitas antarlokasi stabil sebelum melanjutkan ke produksi.</p>
                    <div class="code-block mb-4">
                        <h4>Test Konektivitas dari Mikrotik</h4>
                        <pre><code><span id="code-mikrotik-test">/ping 192.168.113.1 count=5
/tool traceroute address=192.168.113.1</span></code></pre>
                        <button class="copy-btn" onclick="copyCode('code-mikrotik-test')">Salin</button>
                    </div>
                    <div class="not-prose">
                        <div class="info-card bg-blue-50 border-l-4 border-blue-500 shadow-sm">
                            <h4 class="text-lg font-semibold text-blue-700">Ringkasan Testing Bertahap</h4>
                            <div class="overflow-x-auto table-scroll mt-4">
                                <table class="min-w-full divide-y divide-blue-200 text-sm">
                                    <thead class="bg-blue-100 text-blue-800">
                                        <tr>
                                            <th class="px-4 py-2 text-left font-semibold">Tahap</th>
                                            <th class="px-4 py-2 text-left font-semibold">Fokus</th>
                                            <th class="px-4 py-2 text-left font-semibold">Perintah Utama</th>
                                            <th class="px-4 py-2 text-left font-semibold">Ekspektasi</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-blue-100 text-gray-700">
                                        <tr>
                                            <td class="px-4 py-3 font-semibold text-gray-900">Langkah 1  VPS  Mikrotik</td>
                                            <td class="px-4 py-3">Validasi tunnel aktif di kedua arah</td>
                                            <td class="px-4 py-3">
                                                docker exec wg-easy ping -c 5 10.8.0.2<br>
                                                docker exec wg-easy ping -c 5 10.8.0.4<br>
                                                /ping 10.8.0.1 count=5
                                            </td>
                                            <td class="px-4 py-3">0% packet loss dan latency wajar (50-300ms)</td>
                                        </tr>
                                        <tr>
                                            <td class="px-4 py-3 font-semibold text-gray-900">Langkah 2  Site-to-Site Gateway</td>
                                            <td class="px-4 py-3">Pastikan rute antar gateway telah aktif</td>
                                            <td class="px-4 py-3">
                                                /ping 192.168.113.1 count=5<br>
                                                /ping 192.168.110.1 count=5
                                            </td>
                                            <td class="px-4 py-3">Gateway saling merespons tanpa packet loss</td>
                                        </tr>
                                        <tr>
                                            <td class="px-4 py-3 font-semibold text-gray-900">Langkah 3  Device-to-Device</td>
                                            <td class="px-4 py-3">Konfirmasi host LAN lintas lokasi dapat terhubung</td>
                                            <td class="px-4 py-3">
                                                ping 192.168.113.10<br>
                                                ping 192.168.110.10
                                            </td>
                                            <td class="px-4 py-3">Host tujuan reachable dengan latency stabil</td>
                                        </tr>
                                        <tr>
                                            <td class="px-4 py-3 font-semibold text-gray-900">Langkah 4  Status &amp; Monitoring</td>
                                            <td class="px-4 py-3">Pantau handshake dan rute secara real-time</td>
                                            <td class="px-4 py-3">
                                                docker exec wg-easy wg show<br>
                                                /interface wireguard peers print detail
                                            </td>
                                            <td class="px-4 py-3">Latest handshake &lt; 2 menit, traffic RX/TX bertambah</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <h3>Troubleshooting Terstruktur</h3>
                    <p>Telusuri kasus sesuai gejala berikut untuk mempercepat diagnosis dan remediasi.</p>
                    <div class="not-prose space-y-4">
                        <details class="group bg-white border border-blue-100 rounded-xl p-4 shadow-sm">
                            <summary class="flex items-center justify-between cursor-pointer text-blue-600 font-semibold">
                                <span>Kasus 1: Peer Tidak Terhubung ke VPS</span>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="currentColor" class="w-5 h-5 text-blue-500 transition-transform group-open:-rotate-180">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                                </svg>
                            </summary>
                            <div class="mt-4 space-y-4 text-gray-700">
                                <div>
                                    <h4 class="font-semibold text-gray-800">Gejala</h4>
                                    <ul class="list-disc ml-6 space-y-1">
                                        <li>Tidak ada handshake di <code>wg show</code></li>
                                        <li>Ping ke 10.8.0.1 dari Mikrotik gagal</li>
                                        <li>Status peer "not connected" di wg-easy</li>
                                    </ul>
                                </div>
                                <div class="code-block">
                                    <h4>Diagnosis Cepat</h4>
                                    <pre><code><span id="code-troubleshoot1-diagnosis"># Di VPS - cek apakah peer terlihat
docker exec wg-easy wg show

# Di Mikrotik - cek peer configuration
/interface wireguard peers print detail

# Cek firewall VPS
ufw status</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-troubleshoot1-diagnosis')">Salin</button>
                                </div>
                                <div class="code-block">
                                    <h4>Solusi</h4>
                                    <pre><code><span id="code-troubleshoot1-solusi"># Buka port Wireguard di VPS
sudo ufw allow 51820/udp

# Restart interface Wireguard di Mikrotik
/interface wireguard disable wg-site2site
/interface wireguard enable wg-site2site

# Verifikasi endpoint address dan port
/interface wireguard peers print</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-troubleshoot1-solusi')">Salin</button>
                                </div>
                            </div>
                        </details>
                        <details class="group bg-white border border-blue-100 rounded-xl p-4 shadow-sm">
                            <summary class="flex items-center justify-between cursor-pointer text-blue-600 font-semibold">
                                <span>Kasus 2: Handshake Berhasil tapi Ping ke VPS Gagal</span>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="currentColor" class="w-5 h-5 text-blue-500 transition-transform group-open:-rotate-180">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                                </svg>
                            </summary>
                            <div class="mt-4 space-y-4 text-gray-700">
                                <div>
                                    <h4 class="font-semibold text-gray-800">Gejala</h4>
                                    <ul class="list-disc ml-6 space-y-1">
                                        <li>Latest handshake muncul, tetapi transfer data 0</li>
                                        <li>Ping ke 10.8.0.1 timeout</li>
                                        <li>Interface Wireguard terlihat up</li>
                                    </ul>
                                </div>
                                <div class="code-block">
                                    <h4>Diagnosis Cepat</h4>
                                    <pre><code><span id="code-troubleshoot2-diagnosis"># Cek routing di Mikrotik
/ip route print where gateway=wg-site2site

# Cek IP address Wireguard interface
/ip address print where interface=wg-site2site

# Cek firewall rules
/ip firewall filter print where chain=forward</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-troubleshoot2-diagnosis')">Salin</button>
                                </div>
                                <div class="code-block">
                                    <h4>Solusi</h4>
                                    <pre><code><span id="code-troubleshoot2-solusi"># Pastikan IP interface benar
/ip address print where interface=wg-site2site

# Tambahkan route eksplisit bila perlu
/ip route add dst-address=10.8.0.1/32 gateway=wg-site2site

# Pastikan firewall mengizinkan traffic Wireguard
/ip firewall filter print where in-interface=wg-site2site</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-troubleshoot2-solusi')">Salin</button>
                                </div>
                            </div>
                        </details>
                        <details class="group bg-white border border-blue-100 rounded-xl p-4 shadow-sm">
                            <summary class="flex items-center justify-between cursor-pointer text-blue-600 font-semibold">
                                <span>Kasus 3: Mikrotik  Mikrotik Berhasil, tetapi Site-to-Site Gagal</span>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="currentColor" class="w-5 h-5 text-blue-500 transition-transform group-open:-rotate-180">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                                </svg>
                            </summary>
                            <div class="mt-4 space-y-4 text-gray-700">
                                <div>
                                    <h4 class="font-semibold text-gray-800">Gejala</h4>
                                    <ul class="list-disc ml-6 space-y-1">
                                        <li>Ping 10.8.0.2  10.8.0.4 berhasil</li>
                                        <li>Ping 192.168.110.1  192.168.113.1 gagal</li>
                                        <li>Routing di VPS belum lengkap</li>
                                    </ul>
                                </div>
                                <div class="code-block">
                                    <h4>Diagnosis Cepat</h4>
                                    <pre><code><span id="code-troubleshoot3-diagnosis"># Cek routing di VPS container
docker exec wg-easy ip route show

# Pastikan ada route ke subnet lokal
# 192.168.110.0/24 via 10.8.0.2
# 192.168.113.0/24 via 10.8.0.4</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-troubleshoot3-diagnosis')">Salin</button>
                                </div>
                                <div class="code-block">
                                    <h4>Solusi</h4>
                                    <pre><code><span id="code-troubleshoot3-solusi"># Tambahkan route manual di VPS
docker exec wg-easy ip route add 192.168.110.0/24 via 10.8.0.2
docker exec wg-easy ip route add 192.168.113.0/24 via 10.8.0.4

# Verifikasi dan uji ping dari VPS
docker exec wg-easy ip route show
docker exec wg-easy ping -c 3 192.168.110.1
docker exec wg-easy ping -c 3 192.168.113.1</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-troubleshoot3-solusi')">Salin</button>
                                </div>
                            </div>
                        </details>
                        <details class="group bg-white border border-blue-100 rounded-xl p-4 shadow-sm">
                            <summary class="flex items-center justify-between cursor-pointer text-blue-600 font-semibold">
                                <span>Kasus 4: Koneksi Tidak Stabil atau Sering Putus</span>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="currentColor" class="w-5 h-5 text-blue-500 transition-transform group-open:-rotate-180">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                                </svg>
                            </summary>
                            <div class="mt-4 space-y-4 text-gray-700">
                                <div>
                                    <h4 class="font-semibold text-gray-800">Gejala</h4>
                                    <ul class="list-disc ml-6 space-y-1">
                                        <li>Handshake kadang hilang</li>
                                        <li>Ping success rate &lt; 90%</li>
                                        <li>Koneksi drop secara berkala</li>
                                    </ul>
                                </div>
                                <div class="code-block">
                                    <h4>Diagnosis Cepat</h4>
                                    <pre><code><span id="code-troubleshoot4-diagnosis"># Pantau handshake
docker exec wg-easy watch -n 5 'wg show'

# Cek persistent keepalive
/interface wireguard peers print detail

# Monitor variasi latency
/ping 10.8.0.1 count=50</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-troubleshoot4-diagnosis')">Salin</button>
                                </div>
                                <div class="code-block">
                                    <h4>Solusi</h4>
                                    <pre><code><span id="code-troubleshoot4-solusi"># Set keepalive lebih agresif
/interface wireguard peers set 0 persistent-keepalive=15s

# Evaluasi MTU
/interface wireguard set wg-site2site mtu=1280
/ping 10.8.0.1 size=1400 count=10
/ping 10.8.0.1 size=1200 count=10

# Cek kualitas koneksi ISP
/ping 8.8.8.8 count=100 interval=1</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-troubleshoot4-solusi')">Salin</button>
                                </div>
                            </div>
                        </details>
                        <details class="group bg-white border border-blue-100 rounded-xl p-4 shadow-sm">
                            <summary class="flex items-center justify-between cursor-pointer text-blue-600 font-semibold">
                                <span>Kasus 5: Performance Issues (Latency Tinggi/Throughput Rendah)</span>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="currentColor" class="w-5 h-5 text-blue-500 transition-transform group-open:-rotate-180">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                                </svg>
                            </summary>
                            <div class="mt-4 space-y-4 text-gray-700">
                                <div>
                                    <h4 class="font-semibold text-gray-800">Gejala</h4>
                                    <ul class="list-disc ml-6 space-y-1">
                                        <li>Latency &gt; 500 ms secara konsisten</li>
                                        <li>Throughput &lt; 10% dari bandwidth</li>
                                        <li>Packet loss tinggi</li>
                                    </ul>
                                </div>
                                <div class="code-block">
                                    <h4>Diagnosis Cepat</h4>
                                    <pre><code><span id="code-troubleshoot5-diagnosis"># Bandingkan baseline internet
/ping 8.8.8.8 count=20

# Bandingkan kinerja tunnel
/ping 10.8.0.1 count=20

# Uji throughput
/tool bandwidth-test address=192.168.113.1 protocol=tcp</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-troubleshoot5-diagnosis')">Salin</button>
                                </div>
                                <div class="code-block">
                                    <h4>Solusi</h4>
                                    <pre><code><span id="code-troubleshoot5-solusi"># Optimalkan MTU
/interface wireguard set wg-site2site mtu=1420

# Pantau resource VPS
docker stats wg-easy

# Evaluasi lokasi/provider VPS
# Lakukan latency test ke region lain

# Implementasi QoS (opsional)
/queue simple add target=wg-site2site max-limit=50M/50M</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-troubleshoot5-solusi')">Salin</button>
                                </div>
                            </div>
                        </details>
                        <details class="group bg-white border border-blue-100 rounded-xl p-4 shadow-sm">
                            <summary class="flex items-center justify-between cursor-pointer text-blue-600 font-semibold">
                                <span>Kasus 6: Konflik Firewall dengan Hotspot atau Rule Existing</span>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="currentColor" class="w-5 h-5 text-blue-500 transition-transform group-open:-rotate-180">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                                </svg>
                            </summary>
                            <div class="mt-4 space-y-4 text-gray-700">
                                <div>
                                    <h4 class="font-semibold text-gray-800">Gejala</h4>
                                    <ul class="list-disc ml-6 space-y-1">
                                        <li>User hotspot tidak bisa melewati tunnel</li>
                                        <li>Rule firewall existing memblokir traffic</li>
                                        <li>Ada drop rule dinamis yang aktif</li>
                                    </ul>
                                </div>
                                <div class="code-block">
                                    <h4>Diagnosis Cepat</h4>
                                    <pre><code><span id="code-troubleshoot6-diagnosis"># Lihat urutan firewall
/ip firewall filter print

# Identifikasi rule hotspot
/ip firewall filter print where hotspot!=

# Temukan rule drop yang konflik
/ip firewall filter print where action=drop</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-troubleshoot6-diagnosis')">Salin</button>
                                </div>
                                <div class="code-block">
                                    <h4>Solusi</h4>
                                    <pre><code><span id="code-troubleshoot6-solusi"># Susun ulang prioritas firewall
/ip firewall filter move [rule-number] destination=[new-position]

# Tambahkan allow rule khusus Wireguard
/ip firewall filter add action=accept chain=forward src-address=10.8.0.0/24 place-before=0
/ip firewall filter add action=accept chain=forward dst-address=10.8.0.0/24 place-before=0

# Bypass hotspot untuk traffic Wireguard
/ip firewall nat add action=accept chain=hotspot src-address=10.8.0.0/24 place-before=0</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-troubleshoot6-solusi')">Salin</button>
                                </div>
                            </div>
                        </details>
                        <details class="group bg-white border border-blue-100 rounded-xl p-4 shadow-sm">
                            <summary class="flex items-center justify-between cursor-pointer text-blue-600 font-semibold">
                                <span>Kasus 7: Permasalahan DNS</span>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke="currentColor" class="w-5 h-5 text-blue-500 transition-transform group-open:-rotate-180">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                                </svg>
                            </summary>
                            <div class="mt-4 space-y-4 text-gray-700">
                                <div>
                                    <h4 class="font-semibold text-gray-800">Gejala</h4>
                                    <ul class="list-disc ml-6 space-y-1">
                                        <li>Ping IP berhasil tetapi hostname gagal</li>
                                        <li>Resolusi DNS lambat</li>
                                        <li>Terjadi DNS leak</li>
                                    </ul>
                                </div>
                                <div class="code-block">
                                    <h4>Diagnosis Cepat</h4>
                                    <pre><code><span id="code-troubleshoot7-diagnosis"># Uji resolusi DNS umum
/ping google.com
/ping google.com interface=wg-site2site

# Tinjau konfigurasi DNS
/ip dns print</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-troubleshoot7-diagnosis')">Salin</button>
                                </div>
                                <div class="code-block">
                                    <h4>Solusi</h4>
                                    <pre><code><span id="code-troubleshoot7-solusi"># Set DNS server melalui Wireguard
# Update konfigurasi client dengan DNS yang benar

# Aktifkan DNS forwarding
/ip dns set allow-remote-requests=yes servers=1.1.1.1,8.8.8.8

# Tambahkan DNS lokal untuk hostname internal
/ip dns static add name=lokasi-cabang address=192.168.113.1</span></code></pre>
                                    <button class="copy-btn" onclick="copyCode('code-troubleshoot7-solusi')">Salin</button>
                                </div>
                            </div>
                        </details>
                    </div>
                    <h3>Monitoring dan Maintenance</h3>
                    <p>Automasi monitoring adalah kunci untuk memastikan stabilitas. Gunakan skrip-skrip berikut untuk memantau status, bandwidth, dan latensi secara rutin.</p>
                    <div class="not-prose space-y-6">
                        <div class="code-block">
                            <h4>Skrip Health Check Harian</h4>
                            <pre><code><span id="code-health-check">#!/bin/bash
# File: /opt/scripts/wg-healthcheck.sh
echo "=== Wireguard Health Check - $(date) ==="
if docker ps | grep -q wg-easy; then
    echo " wg-easy container: RUNNING"
else
    echo " wg-easy container: DOWN"
    exit 1
fi
echo -e "\n=== Connectivity Test ==="
if docker exec wg-easy ping -c 2 10.8.0.2 >/dev/null 2>&1; then
    echo " Lokasi pertama: REACHABLE"
else
    echo " Lokasi pertama: UNREACHABLE"
fi</span></code></pre>
                            <button class="copy-btn" onclick="copyCode('code-health-check')">Salin</button>
                        </div>
                        <div class="info-card bg-white border border-gray-200 rounded-xl shadow-sm">
                            <h4 class="text-lg font-semibold text-blue-600">Jadwal Maintenance Terencana</h4>
                            <div class="overflow-x-auto table-scroll mt-4">
                                <table class="min-w-full divide-y divide-gray-200 text-sm">
                                    <thead class="bg-gray-100 text-gray-700">
                                        <tr>
                                            <th class="px-4 py-2 text-left font-semibold">Frekuensi</th>
                                            <th class="px-4 py-2 text-left font-semibold">Aktivitas Kunci</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-100 text-gray-700">
                                        <tr>
                                            <td class="px-4 py-3 font-semibold text-gray-900">Harian (otomatis)</td>
                                            <td class="px-4 py-3">
                                                <ul class="list-disc ml-5 space-y-1">
                                                    <li>Connectivity health check</li>
                                                    <li>Monitoring performa dan latency</li>
                                                    <li>Analisis log untuk anomali</li>
                                                    <li>Tracking penggunaan bandwidth</li>
                                                </ul>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-4 py-3 font-semibold text-gray-900">Mingguan</td>
                                            <td class="px-4 py-3">
                                                <ul class="list-disc ml-5 space-y-1">
                                                    <li>Backup sistem komprehensif</li>
                                                    <li>Review update keamanan</li>
                                                    <li>Analisis tren performa</li>
                                                    <li>Review kapasitas dan kebutuhan bandwidth</li>
                                                </ul>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-4 py-3 font-semibold text-gray-900">Bulanan</td>
                                            <td class="px-4 py-3">
                                                <ul class="list-disc ml-5 space-y-1">
                                                    <li>Audit keamanan dan hardening</li>
                                                    <li>Review konfigurasi dan optimasi</li>
                                                    <li>Evaluasi biaya operasional</li>
                                                    <li>Pembaruan dokumentasi</li>
                                                </ul>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-4 py-3 font-semibold text-gray-900">Triwulanan</td>
                                            <td class="px-4 py-3">
                                                <ul class="list-disc ml-5 space-y-1">
                                                    <li>Pengujian disaster recovery</li>
                                                    <li>Penetration testing keamanan</li>
                                                    <li>Evaluasi pembaruan teknologi</li>
                                                    <li>Review kebutuhan bisnis</li>
                                                </ul>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="info-card bg-white border border-gray-200 rounded-xl shadow-sm">
                            <h4 class="text-lg font-semibold text-blue-600">Checklist Final Implementasi</h4>
                            <div class="grid gap-3 md:grid-cols-2 text-gray-700 mt-4">
                                <label class="flex gap-3 items-start">
                                    <input type="checkbox" disabled class="mt-1 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                    <span>All connectivity tests passing secara konsisten</span>
                                </label>
                                <label class="flex gap-3 items-start">
                                    <input type="checkbox" disabled class="mt-1 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                    <span>Monitoring dan alerting aktif</span>
                                </label>
                                <label class="flex gap-3 items-start">
                                    <input type="checkbox" disabled class="mt-1 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                    <span>Prosedur backup dan recovery teruji</span>
                                </label>
                                <label class="flex gap-3 items-start">
                                    <input type="checkbox" disabled class="mt-1 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                    <span>Dokumentasi terbaru dan mudah diakses</span>
                                </label>
                                <label class="flex gap-3 items-start">
                                    <input type="checkbox" disabled class="mt-1 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                    <span>Pelatihan pengguna dan SOP support tersedia</span>
                                </label>
                                <label class="flex gap-3 items-start">
                                    <input type="checkbox" disabled class="mt-1 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                    <span>Security hardening telah diterapkan</span>
                                </label>
                                <label class="flex gap-3 items-start">
                                    <input type="checkbox" disabled class="mt-1 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                    <span>Baseline performa terdokumentasi</span>
                                </label>
                                <label class="flex gap-3 items-start">
                                    <input type="checkbox" disabled class="mt-1 h-4 w-4 text-blue-600 border-gray-300 rounded">
                                    <span>Pelacakan biaya dan prosedur change management disetujui</span>
                                </label>
                            </div>
                        </div>
                        <div class="info-card bg-white border border-gray-200 rounded-xl shadow-sm">
                            <h4 class="text-lg font-semibold text-blue-600">Sumber Daya Komunitas &amp; Dukungan</h4>
                            <div class="grid gap-4 md:grid-cols-2 text-gray-700 mt-4">
                                <div>
                                    <h5 class="font-semibold text-gray-900">Official Documentation</h5>
                                    <ul class="list-disc ml-5 space-y-1">
                                        <li><a href="https://www.wireguard.com/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Wireguard Official Docs</a></li>
                                        <li><a href="https://help.mikrotik.com/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Mikrotik RouterOS Manual</a></li>
                                        <li><a href="https://docs.docker.com/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Docker Documentation</a></li>
                                    </ul>
                                </div>
                                <div>
                                    <h5 class="font-semibold text-gray-900">Community &amp; Support Channels</h5>
                                    <ul class="list-disc ml-5 space-y-1">
                                        <li><a href="https://forum.mikrotik.com/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Mikrotik Community Forum</a></li>
                                        <li><a href="https://www.reddit.com/r/mikrotik/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Reddit r/mikrotik</a> &amp; <a href="https://www.reddit.com/r/WireGuard/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">r/WireGuard</a></li>
                                        <li><a href="https://stackoverflow.com/" class="text-blue-600 hover:underline" target="_blank" rel="noopener">Stack Overflow (tag: wireguard, mikrotik)</a></li>
                                    </ul>
                                </div>
                                <div class="md:col-span-2">
                                    <h5 class="font-semibold text-gray-900">Professional Services</h5>
                                    <p>Pertimbangkan konsultan profesional untuk deployment berskala besar (&gt;10 site), integrasi kompleks, kebutuhan high availability, atau lingkungan dengan tuntutan compliance tinggi.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Optimisasi dan Best Practices -->
        <section class="step-card" id="langkah6">
            <div class="step-header" onclick="toggleSection('optimization', this)" onkeydown="handleStepKey(event, 'optimization', this)" role="button" tabindex="0" aria-expanded="false" aria-controls="content-optimization" data-step-toggle="optimization">
                <div class="step-label">
                    <span class="step-badge">6</span>
                    <span class="step-title">Optimisasi dan Best Practices</span>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6 transform transition-transform duration-300 rotate-0" id="icon-optimization">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                </svg>
            </div>
            <div class="step-content" id="content-optimization" aria-hidden="true">
                <p class="mb-4">Meningkatkan keamanan dan efisiensi untuk penggunaan produksi.</p>
                <div class="prose max-w-none">
                    <h3>Security Hardening</h3>
                    <div class="code-block mb-4">
                        <h4>Enhanced VPS Security</h4>
                        <pre><code><span id="code-security-hardening"># Ubah port SSH
sed -i 's/#Port 22/Port 2222/' /etc/ssh/sshd_config
# Nonaktifkan autentikasi password
sed -i 's/#PasswordAuthentication yes/PasswordAuthentication no/' /etc/ssh/sshd_config
# Tambahkan jail fail2ban untuk Wireguard
# ... (kode lengkap di file asli)
systemctl restart sshd fail2ban</span></code></pre>
                        <button class="copy-btn" onclick="copyCode('code-security-hardening')">Salin</button>
                    </div>
                    <h3>Scalability Planning</h3>
                    <p>Rencanakan alokasi IP untuk penambahan situs di masa depan. Gunakan skrip untuk mempermudah proses.</p>
                    <div class="code-block mb-4">
                        <h4>Skrip untuk Menambahkan Situs Baru</h4>
                        <pre><code><span id="code-add-site">#!/bin/bash
# File: /opt/scripts/add-new-site.sh
SITE_NAME=$1
SITE_IP=$2
SITE_SUBNET=$3
if [ $# -ne 3 ]; then
    echo "Usage: $0 &lt;site-name&gt; &lt;wireguard-ip&gt; &lt;local-subnet&gt;"
    exit 1
fi
echo "Adding new site: $SITE_NAME"
docker exec wg-easy ip route add $SITE_SUBNET via $SITE_IP</span></code></pre>
                        <button class="copy-btn" onclick="copyCode('code-add-site')">Salin</button>
                    </div>
                    <h3>Integrasi dengan Infrastruktur Existing</h3>
                    <p>Pelajari cara mengintegrasikan Wireguard dengan Active Directory, logging terpusat, dan SNMP.</p>
                    <h3>Disaster Recovery Planning</h3>
                    <p>Siapkan prosedur pemulihan untuk skenario terburuk.</p>
                    <div class="code-block mb-4">
                        <h4>Skrip Pemulihan Bencana</h4>
                        <pre><code><span id="code-disaster-recovery">#!/bin/bash
# File: /opt/scripts/wg-recovery.sh
echo "=== Wireguard Disaster Recovery ==="
docker-compose -f /opt/wireguard/docker-compose.yml down
LATEST_BACKUP=$(ls -t /opt/backups/wireguard/wg-config-*.tar.gz | head -1)
echo "Restoring from: $LATEST_BACKUP"
tar -xzf $LATEST_BACKUP -C /
docker-compose -f /opt/wireguard/docker-compose.yml up -d</span></code></pre>
                        <button class="copy-btn" onclick="copyCode('code-disaster-recovery')">Salin</button>
                    </div>
                </div>
            </div>
        </section>

            </div>
        </div>
    </main>

    <footer class="text-white text-center py-6 mt-16">
        <div class="container">
            <p class="text-sm">Tutorial dibuat menggunakan konten dari file `wireguard_site2site_tutorial.md`.</p>
        </div>
    </footer>

    <script>
        // Toggle sections
        function toggleSection(id, trigger) {
            const content = document.getElementById('content-' + id);
            const icon = document.getElementById('icon-' + id);
            const header = trigger || document.querySelector(`[data-step-toggle="${id}"]`);

            if (!content || !icon) return;

            const isOpen = content.classList.contains('active');

            if (isOpen) {
                content.classList.remove('active');
                content.setAttribute('aria-hidden', 'true');
                icon.classList.remove('rotate-180');
                if (header) header.setAttribute('aria-expanded', 'false');
            } else {
                content.classList.add('active');
                content.setAttribute('aria-hidden', 'false');
                icon.classList.add('rotate-180');
                if (header) header.setAttribute('aria-expanded', 'true');
            }
        }

        function handleStepKey(event, id, trigger) {
            if (event.key === 'Enter' || event.key === ' ') {
                event.preventDefault();
                toggleSection(id, trigger);
            }
        }

        // Copy code to clipboard
        function copyCode(id) {
            const codeElement = document.getElementById(id);
            if (!codeElement) return;

            const code = codeElement.innerText;
            const textarea = document.createElement('textarea');
            textarea.value = code;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);

            const container = typeof codeElement.closest === 'function' ? codeElement.closest('.code-block') : null;
            let button = container ? container.querySelector('.copy-btn') : null;

            if (!button) {
                button = Array.from(document.querySelectorAll('.copy-btn')).find(btn => {
                    const onclickValue = btn.getAttribute('onclick') || '';
                    return onclickValue.includes(`copyCode('${id}')`) || onclickValue.includes(`copyCode(\"${id}\")`);
                }) || null;
            }

            if (button) {
                const originalText = button.innerText;
                button.innerText = 'Tersalin!';
                setTimeout(() => {
                    button.innerText = originalText;
                }, 2000);
            }
        }

        // Tabs handling inside accordion panels
        function initTabs() {
            const tabGroups = document.querySelectorAll('.tab-group');
            tabGroups.forEach(group => {
                const buttons = group.querySelectorAll('.tab-button');
                const contents = group.querySelectorAll('.tab-content');

                buttons.forEach(button => {
                    button.addEventListener('click', () => {
                        const target = button.getAttribute('data-tab');

                        buttons.forEach(btn => btn.classList.remove('active'));
                        button.classList.add('active');

                        contents.forEach(content => {
                            if (content.getAttribute('data-tab-content') === target) {
                                content.classList.add('active');
                            } else {
                                content.classList.remove('active');
                            }
                        });
                    });
                });
            });
        }

        function initMobileNav() {
            const toggle = document.querySelector('[data-mobile-nav-toggle]');
            const quickNav = document.getElementById('quickNav');

            if (!toggle || !quickNav) return;

            const setState = expanded => {
                toggle.setAttribute('aria-expanded', expanded ? 'true' : 'false');
                quickNav.classList.toggle('open', expanded);
            };

            setState(false);

            toggle.addEventListener('click', () => {
                const expanded = toggle.getAttribute('aria-expanded') === 'true';
                setState(!expanded);
            });

            quickNav.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    if (window.innerWidth < 1024) {
                        setState(false);
                    }
                });
            });

            const syncWithViewport = () => {
                if (window.innerWidth >= 1024) {
                    quickNav.classList.remove('open');
                    toggle.setAttribute('aria-expanded', 'false');
                }
            };

            syncWithViewport();
            window.addEventListener('resize', syncWithViewport);
        }

        // D3.js chart for VPN comparison
        function createComparisonChart() {
            const data = [
                { name: 'Wireguard', performance: 90, simplicity: 95, security: 85 },
                { name: 'OpenVPN', performance: 65, simplicity: 60, security: 90 },
                { name: 'IPSec', performance: 75, simplicity: 40, security: 95 }
            ];

            const svgElement = d3.select("#vpn-comparison");
            const containerNode = svgElement.node();
            if (!containerNode) return;

            const parentWidth = containerNode.parentElement ? containerNode.parentElement.clientWidth : containerNode.clientWidth;
            if (!parentWidth) return;

            const margin = { top: 20, right: 24, bottom: 40, left: 50 };
            const height = 260;
            const width = Math.max(parentWidth - margin.left - margin.right, 0);
            const totalWidth = width + margin.left + margin.right;
            const totalHeight = height + margin.top + margin.bottom;

            svgElement.selectAll("*").remove();
            svgElement
                .attr("width", "100%")
                .attr("height", totalHeight)
                .attr("viewBox", `0 0 ${totalWidth} ${totalHeight}`)
                .attr("preserveAspectRatio", "xMidYMid meet");

            const svg = svgElement
                .append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);

            const x = d3.scaleBand()
                .domain(data.map(d => d.name))
                .range([0, width])
                .padding(width < 420 ? 0.3 : 0.2);

            const tickFontSize = width < 360 ? "12px" : "14px";

            svg.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(x).tickSize(0))
                .selectAll("text")
                .attr("transform", "translate(0,10)")
                .style("text-anchor", "middle")
                .style("font-size", tickFontSize);

            const y = d3.scaleLinear()
                .domain([0, 100])
                .range([height, 0]);

            svg.append("g")
                .call(d3.axisLeft(y).ticks(5).tickSizeOuter(0));

            const barWidth = x.bandwidth() / 3;

            svg.selectAll(".bar-performance")
                .data(data)
                .enter().append("rect")
                .attr("class", "bar-performance")
                .attr("x", d => x(d.name))
                .attr("y", d => y(d.performance))
                .attr("width", barWidth)
                .attr("height", d => height - y(d.performance))
                .attr("fill", "#3b82f6")
                .attr("rx", 5)
                .attr("ry", 5);

            svg.selectAll(".bar-simplicity")
                .data(data)
                .enter().append("rect")
                .attr("class", "bar-simplicity")
                .attr("x", d => x(d.name) + barWidth)
                .attr("y", d => y(d.simplicity))
                .attr("width", barWidth)
                .attr("height", d => height - y(d.simplicity))
                .attr("fill", "#60a5fa")
                .attr("rx", 5)
                .attr("ry", 5);

            svg.selectAll(".bar-security")
                .data(data)
                .enter().append("rect")
                .attr("class", "bar-security")
                .attr("x", d => x(d.name) + (barWidth * 2))
                .attr("y", d => y(d.security))
                .attr("width", barWidth)
                .attr("height", d => height - y(d.security))
                .attr("fill", "#93c5fd")
                .attr("rx", 5)
                .attr("ry", 5);

            const legendData = [
                { label: 'Performa', color: '#3b82f6' },
                { label: 'Kemudahan Konfigurasi', color: '#60a5fa' },
                { label: 'Keamanan', color: '#93c5fd' }
            ];

            const legendOffsetX = Math.max(0, width - 160);
            const legend = svg.append("g")
                .attr("class", "legend")
                .attr("transform", `translate(${legendOffsetX},0)`);

            legendData.forEach((item, index) => {
                const yOffset = index * 22;
                legend.append("circle")
                    .attr("cx", 0)
                    .attr("cy", yOffset)
                    .attr("r", 6)
                    .style("fill", item.color);

                legend.append("text")
                    .attr("x", 12)
                    .attr("y", yOffset)
                    .attr("dy", "0.32em")
                    .text(item.label)
                    .style("font-size", tickFontSize)
                    .style("fill", "#1f2937");
            });
        }

        // D3.js network topology
        function createNetworkTopology() {
            const links = [
                { source: "Internet A", target: "Mikrotik A" },
                { source: "Mikrotik A", target: "LAN A" },
                { source: "Internet B", target: "Mikrotik B" },
                { source: "Mikrotik B", target: "LAN B" },
                { source: "VPS Wireguard", target: "Internet A" },
                { source: "VPS Wireguard", target: "Internet B" }
            ];

            const nodes = [
                { id: "Internet A", type: "internet", fx: 150, fy: 50 },
                { id: "Mikrotik A", type: "router", fx: 150, fy: 200 },
                { id: "LAN A", type: "lan", fx: 150, fy: 350 },
                { id: "Internet B", type: "internet", fx: 650, fy: 50 },
                { id: "Mikrotik B", type: "router", fx: 650, fy: 200 },
                { id: "LAN B", type: "lan", fx: 650, fy: 350 },
                { id: "VPS Wireguard", type: "vps", fx: 400, fy: 200 }
            ];

            const svg = d3.select("#network-topology");
            const width = +svg.attr("viewBox").split(" ")[2];
            const height = +svg.attr("viewBox").split(" ")[3];

            const simulation = d3.forceSimulation(nodes)
                .force("link", d3.forceLink(links).id(d => d.id).distance(100))
                .force("charge", d3.forceManyBody().strength(-200))
                .force("center", d3.forceCenter(width / 2, height / 2))
                .stop();

            for (let i = 0; i < 300; ++i) simulation.tick();

            const link = svg.append("g")
                .attr("stroke", "#999")
                .attr("stroke-opacity", 0.6)
                .selectAll("line")
                .data(links)
                .join("line")
                .attr("stroke-width", 2)
                .attr("stroke", d => d.source.id === "VPS Wireguard" || d.target.id === "VPS Wireguard" ? "#10b981" : "#999");
            
            const node = svg.append("g")
                .attr("stroke", "#fff")
                .attr("stroke-width", 1.5)
                .selectAll("g")
                .data(nodes)
                .join("g");

            node.append("circle")
                .attr("r", 20)
                .attr("fill", d => {
                    if (d.type === "router") return "#3b82f6";
                    if (d.type === "vps") return "#ef4444";
                    return "#6b7280";
                });
            
            node.append("text")
                .attr("dy", "0.31em")
                .attr("x", 25)
                .text(d => d.id)
                .style("font-size", "14px")
                .style("fill", "#1f2937");

            function ticked() {
                link
                    .attr("x1", d => d.source.x)
                    .attr("y1", d => d.source.y)
                    .attr("x2", d => d.target.x)
                    .attr("y2", d => d.target.y);
                node
                    .attr("transform", d => `translate(${d.x},${d.y})`);
            }
            simulation.on("tick", ticked);
            ticked(); // Initial render
        }

        // D3.js latency chart
        function createLatencyChart() {
            const data = [
                { label: 'Direct', min: 10, avg: 50, max: 80 },
                { label: 'VPN Tunneled', min: 100, avg: 180, max: 300 }
            ];

            const svgElement = d3.select("#latency-chart");
            const containerNode = svgElement.node();
            if (!containerNode) return;

            const parentWidth = containerNode.parentElement ? containerNode.parentElement.clientWidth : containerNode.clientWidth;
            if (!parentWidth) return;

            const margin = { top: 20, right: 24, bottom: 40, left: 50 };
            const height = 260;
            const width = Math.max(parentWidth - margin.left - margin.right, 0);
            const totalWidth = width + margin.left + margin.right;
            const totalHeight = height + margin.top + margin.bottom;

            svgElement.selectAll("*").remove();
            svgElement
                .attr("width", "100%")
                .attr("height", totalHeight)
                .attr("viewBox", `0 0 ${totalWidth} ${totalHeight}`)
                .attr("preserveAspectRatio", "xMidYMid meet");

            const svg = svgElement
                .append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);

            const x = d3.scaleBand()
                .domain(data.map(d => d.label))
                .range([0, width])
                .padding(width < 420 ? 0.35 : 0.4);

            const tickFontSize = width < 360 ? "12px" : "14px";

            svg.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(x).tickSize(0))
                .selectAll("text")
                .attr("transform", "translate(0,10)")
                .style("text-anchor", "middle")
                .style("font-size", tickFontSize);

            const y = d3.scaleLinear()
                .domain([0, 400])
                .range([height, 0]);

            svg.append("g")
                .call(d3.axisLeft(y).ticks(5).tickSizeOuter(0));

            const colors = {
                min: "#10b981",
                avg: "#f59e0b",
                max: "#ef4444"
            };

            const barWidth = x.bandwidth() / 3;

            svg.selectAll(".bar-min")
                .data(data)
                .enter().append("rect")
                .attr("class", "bar-min")
                .attr("x", d => x(d.label))
                .attr("y", d => y(d.min))
                .attr("width", barWidth)
                .attr("height", d => height - y(d.min))
                .attr("fill", colors.min)
                .attr("rx", 4)
                .attr("ry", 4);

            svg.selectAll(".bar-avg")
                .data(data)
                .enter().append("rect")
                .attr("class", "bar-avg")
                .attr("x", d => x(d.label) + barWidth)
                .attr("y", d => y(d.avg))
                .attr("width", barWidth)
                .attr("height", d => height - y(d.avg))
                .attr("fill", colors.avg)
                .attr("rx", 4)
                .attr("ry", 4);

            svg.selectAll(".bar-max")
                .data(data)
                .enter().append("rect")
                .attr("class", "bar-max")
                .attr("x", d => x(d.label) + 2 * barWidth)
                .attr("y", d => y(d.max))
                .attr("width", barWidth)
                .attr("height", d => height - y(d.max))
                .attr("fill", colors.max)
                .attr("rx", 4)
                .attr("ry", 4);

            const legendData = [
                { label: 'Minimum', color: colors.min },
                { label: 'Rata-rata', color: colors.avg },
                { label: 'Maksimum', color: colors.max }
            ];

            const legendOffsetX = Math.max(0, width - 160);
            const legend = svg.append("g")
                .attr("class", "legend")
                .attr("transform", `translate(${legendOffsetX},0)`);

            legendData.forEach((item, index) => {
                const yOffset = index * 22;
                legend.append("circle")
                    .attr("cx", 0)
                    .attr("cy", yOffset)
                    .attr("r", 6)
                    .style("fill", item.color);

                legend.append("text")
                    .attr("x", 12)
                    .attr("y", yOffset)
                    .attr("dy", "0.32em")
                    .text(item.label)
                    .style("font-size", tickFontSize)
                    .style("fill", "#1f2937");
            });
        }
        
        // Initial setup on window load
        window.onload = function() {
            initTabs();
            initMobileNav();
            createComparisonChart();
            createNetworkTopology();
            createLatencyChart();
        }

        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                createComparisonChart();
                createLatencyChart();
            }, 200);
        });
    </script>
</body>
</html>
